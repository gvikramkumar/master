<div class="add-form-container">
  <cui-select [items]="measures" label="Measure Name" empty="true" [(ngModel)]="sm.measureName" required="true"
              optionsKey="name" optionsValue="name" (selectChange)="measureNameChange()"></cui-select>

  <cui-input type="text" [(model)]="sm.name" label="Sub-Measure Name" required="true"></cui-input>

  <cui-select [fxShow]="showCategories" [items]="categoryTypes" label="Submeasure Category Type" empty="true"
              optionsKey="name" optionsValue="value" [(ngModel)]="sm.categoryType"></cui-select>

  <cui-input type="textarea" [(model)]="sm.description" label="Description"></cui-input>

  <cui-input type="textarea" [(model)]="sm.source" label="Source"></cui-input>
  <br><br>

  <fieldset class="input-filter-level">
    <legend>Input Filter Level*</legend>

    <div class="two-col-row">
      <div class="left columnHeader">Hierarchy</div>
      <div class="right columnHeader">Hierarchy Level</div>
    </div>

    <div class="two-col-row">
      <div class="left">
        <cui-input class="switch" type="switch" [(model)]="ifl_switch_ibe" label="Internal Business Entity"
                   (modelChange)="iflChange('ibe')"></cui-input>
      </div>
      <div class="right">
        <cui-select [fxShow]="ifl_switch_ibe" class="option" [items]="ibe_items" optionsKey="name"
                    optionsValue="value" [(ngModel)]="sm.inputFilterLevel.internalBELevel"></cui-select>
      </div>
    </div>

    <div class="two-col-row">
      <div class="left">
        <cui-input type="switch" [(model)]="ifl_switch_p" label="Product" (modelChange)="iflChange('p')"></cui-input>
      </div>
      <div class="right">
        <cui-select [fxShow]="ifl_switch_p" class="option" [items]="p_items" optionsKey="name"
                    optionsValue="value" [(ngModel)]="sm.inputFilterLevel.productLevel"></cui-select>
      </div>
    </div>

    <div class="two-col-row">
      <div class="left">
        <cui-input type="switch" [(model)]="ifl_switch_le" label="Legal Entity"></cui-input>
      </div>
      <div class="right">
        <cui-select [fxShow]="ifl_switch_le" class="option" [items]="le_items" optionsKey="name"
                    optionsValue="value" [(ngModel)]="sm.inputFilterLevel.entityLevel"></cui-select>
      </div>
    </div>

    <div class="two-col-row">
      <div class="left">
        <cui-input type="switch" [(model)]="ifl_switch_s" label="Sales"></cui-input>
      </div>
      <div class="right">
        <cui-select [fxShow]="ifl_switch_s" class="option" [items]="s_items" optionsKey="name"
                    optionsValue="value" [(ngModel)]="sm.inputFilterLevel.salesLevel"></cui-select>
      </div>
    </div>

    <div class="two-col-row">
      <div class="left">
        <cui-input type="switch" [(model)]="ifl_switch_scms" label="SCMS"></cui-input>
      </div>
      <div class="right">
        <cui-select [fxShow]="ifl_switch_scms" class="option" [items]="scms_items" optionsKey="name"
                    optionsValue="value" [(ngModel)]="sm.inputFilterLevel.scmsLevel"></cui-select>
      </div>
    </div>
  </fieldset>
  <br>


  <fieldset class="input-filter-level">
    <legend>Manual Mapping</legend>

    <div class="two-col-row">
      <div class="left columnHeader">Hierarchy</div>
      <div class="right columnHeader">Hierarchy Level</div>
    </div>

    <div class="two-col-row">
      <div class="left">
        <cui-input class="switch" type="switch" [(model)]="mm_switch_ibe" label="Internal Business Entity"
                   (modelChange)="mmChange('ibe')"></cui-input>
      </div>
      <div class="right">
        <cui-select [fxShow]="mm_switch_ibe" class="option" [items]="ibe_items" optionsKey="name"
                    optionsValue="value" [(ngModel)]="sm.manualMapping.internalBELevel"></cui-select>
      </div>
    </div>

    <div class="two-col-row">
      <div class="left">
        <cui-input type="switch" [(model)]="mm_switch_p" label="Product" (modelChange)="mmChange('p')"></cui-input>
      </div>
      <div class="right">
        <cui-select [fxShow]="mm_switch_p" class="option" [items]="p_items" optionsKey="name"
                    optionsValue="value" [(ngModel)]="sm.manualMapping.productLevel"></cui-select>
      </div>
    </div>

    <div class="two-col-row">
      <div class="left">
        <cui-input type="switch" [(model)]="mm_switch_le" label="Legal Entity"></cui-input>
      </div>
      <div class="right">
        <cui-select [fxShow]="mm_switch_le" class="option" [items]="le_items" optionsKey="name"
                    optionsValue="value" [(ngModel)]="sm.manualMapping.entityLevel"></cui-select>
      </div>
    </div>

    <div class="two-col-row">
      <div class="left">
        <cui-input type="switch" [(model)]="mm_switch_s" label="Sales"></cui-input>
      </div>
      <div class="right">
        <cui-select [fxShow]="mm_switch_s" class="option" [items]="s_items" optionsKey="name"
                    optionsValue="value" [(ngModel)]="sm.manualMapping.salesLevel"></cui-select>
      </div>
    </div>

    <div class="two-col-row">
      <div class="left">
        <cui-input type="switch" [(model)]="mm_switch_scms" label="SCMS"></cui-input>
      </div>
      <div class="right">
        <cui-select [fxShow]="mm_switch_scms" class="option" [items]="scms_items" optionsKey="name"
                    optionsValue="value" [(ngModel)]="sm.manualMapping.scmsLevel"></cui-select>
      </div>
    </div>
  </fieldset>
  <br>

  <cui-select [items]="yearmos" label="Effective Month" empty="true" [(ngModel)]="sm.startFiscalMonth"
              required="true" optionsKey="long" optionsValue="num"></cui-select>

  <cui-select [items]="timings" label="Processing Timing" empty="true" [(ngModel)]="sm.processingTime"
              optionsKey="name" optionsValue="value"></cui-select>

  <cui-select [items]="groupings" label="P&L Node Grouping" empty="true" [(ngModel)]="sm.pnlnodeGrouping"
              optionsKey="name" optionsValue="value"></cui-select>
  <br><br>

  <fieldset>
    <legend>Legacy Reporting Support</legend>
  <cui-input type="text" [(model)]="sm.reportingLevels[0]" label="Reporting Level 1"></cui-input>
  <cui-input type="text" [(model)]="sm.reportingLevels[1]" label="Reporting Level 2"></cui-input>
  <cui-input type="text" [(model)]="sm.reportingLevels[2]" label="Reporting Level 3"></cui-input>
  </fieldset>
    <br><br>

  <fieldset>
    <legend>
      <img matTooltip="Attach up to 5 rules" matTooltipPosition="left" src="assets/img/tooltip.png" class="tooltip"
           width="18">
      Rule Association
    </legend>

  <div *ngFor="let rule of sm.rules; let i = index;">
    <cui-select [items]="rules" label="Associated Rule(s)" empty="true"
                [(ngModel)]="sm.rules[i]" optionsKey="name" optionsValue="name"></cui-select>
  </div>
  </fieldset>

  <button type="button" [disabled]="sm.rules.length >= 5" (click)="addRule()">+</button>
  <button type="button" [disabled]="!sm.rules.length" (click)="removeRule()">-</button>
  <br><br>
  <button (click)="resetForm()">Reset</button>
  <button (click)="save()">Submit</button>
  <button>Cancel</button>
  <br>
</div>
