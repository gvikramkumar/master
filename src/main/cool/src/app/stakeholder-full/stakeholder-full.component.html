<div class="content">
    <div class="container-fluid">
        <app-menu-bar [caseId]="caseId" 
        [stakeData]="stakeHolderInfo"
        [offerId]="currentOfferId"
      [offerName]="offerBuilderdata['offerName']"
        (updateMessage)="updateMessage($event)">
        </app-menu-bar>
        <div class="panel-wrapper mt-15">

            <!-- Blue bar -->
            <div class="panel panel--indigo panel--compressed task--bar">
                <div class="row">
                    <div class="col-md-4">
                        <h4><button [disabled]="!backbuttonStatusValid" class="btn--back btn btn--icon btn--white"><span class="icon-back" (click)="gotoMMpage()"></span></button>
                            Stakeholders</h4>
                    </div>
                    <div class="col-md-8 text-right">
                        <button class="btn btn--white" (click)="gotoOfferviewDetails()"> Offer Detail View </button>
                        <!-- <button class="btn btn--white"><span class="icon-export"></span> Export </button> -->
                        <button class="btn btn--white" [disabled]="!proceedButtonStatusValid" (click)=' addCollaborator()'>Proceed to Strategy
                            Review <span class="icon-chevron-right"></span></button>
                    </div>
                </div>
            </div>

            <div class="contentBox mt-10">
                    <div class="alert base-margin-top half-margin-bottom" [ngClass]="{'alert--info':message['color']==='black','alert--success': message['color']==='green','alert--danger': message['color']==='red','alert--warning': message['color']==='yellow'}">
                            <div class="alert__icon mm-alert-icon" [ngClass]="{'icon-info-outline': message['color']==='black','icon-error-outline': message['color']==='red','icon-check-outline': message['color']==='green', 'icon-warning-outline': message['color']==='yellow'}"></div>
                            <div class="alert__message" [ngStyle]="{'color': message['color']}"><b>{{message['contentHead']}}</b>&nbsp;{{message['content']}}</div>
                        </div>
                <div class="card card--raised base-margin-top">
                    <ul class="list">
                        <li *ngFor="let key of getKeys(stakeHolderInfo)">
                            <div *ngIf="key !== 'Stakeholders'">
                                <div class="ui-accordion-header"><span class="text-uppercase">{{key}}
                                        ({{stakeHolderInfo[key].length}})</span><span class="icon-chevron-up icon-small pull-right"></span></div>
                                <div class="ui-accordion-content">
                                    <div *ngFor="let coOwners of stakeHolderInfo[key]">
                                        <div class="flex-center-vertical">
                                            <!-- Team Member Name Avatar -->
                                            <span class="avatar-ico">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 36 36"
                                                    id="fwt-profile-button-loggedin" role="img">
                                                    <title id="fwt-profile-button-loggedin-title"></title>
                                                    <g fill="none" fill-rule="evenodd">
                                                        <path stroke="#4d4c4c" stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2" d="M22.857 31.36c-1.616.614-3.37.95-5.202.95C9.56 32.31 3 25.749 3 17.655S9.561 3 17.655 3 32.31 9.561 32.31 17.655c0 3.988-1.727 7.703-4.31 10.344"
                                                            x="0" y="0"></path>
                                                        <text fill="#007493" font-family="CiscoSans, Arial, sans-serif"
                                                            font-weight="300" font-size="16" x="50%" y="50%" dy=".35em"
                                                            text-anchor="middle" id="fwt-initials">{{getInitialChar(coOwners['name'])}}</text>
                                                    </g>
                                                </svg>
                                            </span>
                                            <div class="flex-fluid text-left half-margin-left">
                                                <div class="text-bold">{{coOwners['name']}}</div>
                                                <div>{{coOwners['email']}}</div>
                                            </div>
                                        </div>
                                        <div class="divider divider--compressed"></div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <!-- Here goes stakeholders list-->

                        <li>
                            <div class="ui-accordion-header"><span class="text-uppercase"> Stakeholders
                                    ({{Stakeholders.length}})</span><span class="icon-chevron-up icon-small pull-right"></span></div>
                            <div class="ui-accordion-content">
                                <div class="panel panel--compressed panel--ltgray panel--loose">
                                    <span>Add Stakeholders</span>
                                    <form [formGroup]="stakeholderForm" (ngSubmit)="onAdd()">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group half-margin-bottom">
                                                    <div class="form-group__text">
                                                        <p-autoComplete [(ngModel)]="val" formControlName="userName"
                                                            [suggestions]="results" (completeMethod)="search($event)"
                                                            [size]="100" field="userName" [minLength]="2" scrollHeight="150px"
                                                            placeholder="SEARCH BY STAKEHOLDER NAME">
                                                            <ng-template pTemplate="body" let-stakes>
                                                                <tbody>
                                                                    <tr>
                                                                        <td>
                                                                            {{stakes.userName}}
                                                                        </td>
                                                                        <td>
                                                                            {{stakes.emailId}}
                                                                        </td>
                                                                        <td>
                                                                            {{stakes.userMappings[0].functionalRole}}
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </ng-template>
                                                        </p-autoComplete>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group half-margin-bottom">
                                                    <div class="form-group__text select">
                                                        <select id="selectedFunction" class="form-control"
                                                            formControlName="functionalRole">
                                                            <option [ngValue]="null">SELECT FUNCTION</option>
                                                            <option *ngFor="let functionalRole of funcionalRoleList"
                                                                value={{functionalRole}}>
                                                                {{functionalRole}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-1">
                                                <button class="btn btn--primary" type="submit" [disabled]="!stakeholderForm.valid">ADD</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>

                                <div class="responsive-table base-margin-top">
                                    <p-table #dt [columns]="cols" [value]="Stakeholders"
                                        [(selection)]="selectedSh" [rows]="6">
                                        <ng-template pTemplate="header" let-columns>
                                            <tr>
                                                <th style="width: 2.25em">
                                                    <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                                </th>
                                                <th *ngFor="let col of columns">
                                                    {{col.header}}
                                                </th>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-stakeholder>
                                            <tr>
                                                <td>
                                                    <p-tableCheckbox [value]="stakeholder" [disabled]="stakeholder.stakeholderDefaults" ></p-tableCheckbox>
                                                </td>
                                                <td>{{stakeholder.name}}</td>
                                                <td>{{stakeholder.email}}</td>
                                                <td>
                                                    {{stakeholder.functionalRole}}
                                                    <span *ngIf="!stakeholder.stakeholderDefaults" class="icon-trash icon-small pull-right" (click)="deleteStakeHolder(stakeholder._id)"></span>
                                                </td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                </div>
                            </div>
                        </li>
                    </ul>
                    <div class="col-md-12 base-margin-top">
                        <button class="btn btn--primary" (click)="delteSelectedStakeHolders()">REMOVE</button>
                    </div>
                </div>
            </div>
            <div class="base-margin-top"></div>
            <!--<div class="contentBox mt-10">
                <div class="card card--raised base-margin-top">
                    <ul class="list">
                        <li>
                            <div class="ui-accordion-header"><span class="icon-chevron-up icon-small pull-right"></span></div>
                            <div class="ui-accordion-content">
                                <div *ngFor="let d of data">
                                    <div class="flex-center-vertical">
                                        <span class="avatar-ico">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 36 36"
                                                id="fwt-profile-button-loggedin" role="img">
                                                <title id="fwt-profile-button-loggedin-title"></title>
                                                <g fill="none" fill-rule="evenodd">
                                                    <path stroke="#4d4c4c" stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M22.857 31.36c-1.616.614-3.37.95-5.202.95C9.56 32.31 3 25.749 3 17.655S9.561 3 17.655 3 32.31 9.561 32.31 17.655c0 3.988-1.727 7.703-4.31 10.344"
                                                        x="0" y="0"></path>
                                                    <text fill="#007493" font-family="CiscoSans, Arial, sans-serif"
                                                        font-weight="300" font-size="16" x="50%" y="50%" dy=".35em"
                                                        text-anchor="middle" id="fwt-initials">{{getInitialChar(d['userName'])}}</text>
                                                </g>
                                            </svg>
                                        </span>
                                        <div class="flex-fluid text-left half-margin-left">
                                            <div class="text-bold">{{d._id}}
                                                <button class="btn btn--primary" *ngIf="!d.stakeholderDefaults" (click)=" onDelete(d)">Remove</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="divider divider--compressed"></div>
                                </div>
                            </div>
                        </li>

                        <li>
                            <div class="ui-accordion-header">Stakeholders<span class="icon-chevron-up icon-small pull-right"></span></div>
                            <div class="ui-accordion-content">

                                <form [formGroup]="stakeholderForm" (ngSubmit)="onSearch()">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group half-margin-bottom">
                                                <div class="form-group__text">
                                                    <input id="name" placeholder="Search by Name, Email" class="form-control"
                                                        formControlName="name">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group half-margin-bottom">
                                                <div class="form-group__text select">
                                                    <select id="selectedFunction" class="form-control" formControlName="businessEntity">
                                                        <option [ngValue]="null">BusinessEntity</option>
                                                        <option *ngFor="let businessEntity of entityList" value={{businessEntity}}>
                                                            {{businessEntity}}</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group half-margin-bottom">
                                                <div class="form-group__text select">
                                                    <select id="selectedFunction" class="form-control" formControlName="functionName">
                                                        <option [ngValue]="null">Function</option>
                                                        <option *ngFor="let businessEntity of funcionalRoleList" value={{businessEntity}}>
                                                            {{businessEntity}}</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-1">
                                            <button class="btn btn--primary" (click)="onSearch()">Search</button>
                                        </div>
                                    </div>
                                </form>
                                <div class="divider divider--compressed"></div>
                                <h4 (mouseover)="onOut($event, user)">Search Results</h4>
                                <span>
                                    <p-dataTable *ngIf="collaboratorsList" [value]="collaboratorsList" [(selection)]="selectedCollabs"
                                        (selectionChange)="selectlist($event)" (mouseover)="onEvent($event, user)"
                                        dataKey="email" #dt>


                                        <p-column [style]="{'width': '50px'}" selectionMode="multiple"></p-column>
                                        <p-column field="functionalRole" header="Function"></p-column>
                                        <p-column field="applicationRole" header="Roles">

                                        </p-column>
                                        <p-column field="name" header="Name"></p-column>
                                        <p-column field="email" header="Email"></p-column>
                                        <p-column field="businessEntity" header="BusinessEntity"></p-column>
                                        <p-column header="delete">
                                            <ng-template pTemplate="header">
                                            </ng-template>
                                            <ng-template let-user="rowData" pTemplate="body">
                                                <button type="button" pButton *ngIf="showDelete" (click)="onDelete(user)"
                                                    icon="fa-delete">delete</button>
                                            </ng-template>
                                        </p-column>
                                    </p-dataTable>
                                </span>
                                <br>
                                <button class="btn btn--primary" (click)="addselectedCollabs()">Add</button>

                            </div>
                        </li>
                    </ul>
                </div>
            </div> -->
        </div>
    </div>
</div>
